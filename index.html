<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ML / AI — Live Articles</title>
  <style>
    :root{--bg:#0b0f14;--card:#111826;--muted:#9fb1c7;--text:#e8f0fb;--accent:#3ba9ff}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,Segoe UI,Roboto,Inter,Arial}
    header{max-width:1100px;margin:28px auto 8px;padding:0 16px}
    h1{font-size:26px;margin:0 0 6px}
    .sub{color:var(--muted);font-size:14px}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1100px;margin:10px auto 60px;padding:0 16px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:14px}
    .card{background:var(--card);border-radius:14px;padding:14px;box-shadow:0 6px 14px rgba(0,0,0,.25)}
    .src{font-size:12px;color:var(--muted)}
    .title{font-weight:700;margin:6px 0 4px}
    .desc{color:#cfe0f7;font-size:14px}
    .meta{display:flex;gap:10px;margin-top:8px;color:var(--muted);font-size:12px}
    .thumb{width:100%;height:150px;object-fit:cover;border-radius:10px;margin:6px 0;display:none}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:10px 0 18px}
    select,button{background:#0f1520;color:var(--text);border:1px solid #1e2a3d;border-radius:10px;padding:8px 12px}
    .error{color:#ffb4b4}
  </style>
</head>
<body>
  <header>
    <h1>ML / AI — Live Articles & Journals</h1>
    <div class="sub">Hand-picked blogs, research and updates straight from the silicon valley.</div>
  </header>

  <div class="wrap">
    <div class="controls">
      <label>Source:
        <select id="sourceFilter"></select>
      </label>
      <button id="refreshBtn">Refresh</button>
      <span id="status" class="sub"></span>
    </div>
    <div id="grid" class="grid"></div>
    <div id="err" class="error"></div>
  </div>

  <script>
  const PROXY_BASE = "https://rss-proxy.yasirkaleem.workers.dev/"; // your Worker

  // Mostly-articles from reputable ML/AI sources
  const FEEDS = [
    {name:"Google AI (The Keyword)", url:"https://blog.google/technology/ai/rss/"},             // :contentReference[oaicite:0]{index=0}
    {name:"Google Research Blog",     url:"https://research.google/blog/rss/"},                  // :contentReference[oaicite:1]{index=1}
    {name:"DeepMind Blog",            url:"https://deepmind.google/blog/rss.xml"},               // :contentReference[oaicite:2]{index=2}
    {name:"Microsoft Research Blog",  url:"https://www.microsoft.com/en-us/research/feed/"},     // :contentReference[oaicite:3]{index=3}
    {name:"BAIR (Berkeley) Blog",     url:"https://bair.berkeley.edu/blog/feed.xml"},            // :contentReference[oaicite:4]{index=4}
    {name:"The Gradient",             url:"https://thegradient.pub/rss/"},                       // :contentReference[oaicite:5]{index=5}
    {name:"Nature Machine Intelligence", url:"https://www.nature.com/natmachintell.rss"},        // :contentReference[oaicite:6]{index=6}
    {name:"Nature — Machine Learning (subject)", url:"https://www.nature.com/subjects/machine-learning.rss"}, // :contentReference[oaicite:7]{index=7}
    {name:"Allen Institute for AI (AI2)", url:"https://allenai.org/rss.xml"},                    // :contentReference[oaicite:8]{index=8}
    {name:"NVIDIA Developer Blog",    url:"https://developer.nvidia.com/blog/feed"},             // :contentReference[oaicite:9]{index=9}
    {name:"Meta Research",            url:"https://research.facebook.com/feed/"}                 // :contentReference[oaicite:10]{index=10}
    // optional research feed (uncomment if you want): {name:"arXiv: cs.LG", url:"https://export.arxiv.org/rss/cs.LG"}
  ];

  const MAX_ITEMS_PER_FEED = 8;   // keep signal high
  const MAX_TOTAL_ITEMS     = 60;

  const sourceSel = document.getElementById('sourceFilter');
  const grid = document.getElementById('grid');
  const statusEl = document.getElementById('status');
  const errEl = document.getElementById('err');
  const refreshBtn = document.getElementById('refreshBtn');

  FEEDS.forEach((f,i)=>{
    const opt = document.createElement('option');
    opt.value = i; opt.textContent = f.name;
    sourceSel.appendChild(opt);
  });
  // "All sources" option
  const allOpt = document.createElement('option');
  allOpt.value = 'all'; allOpt.textContent = 'All sources';
  sourceSel.insertBefore(allOpt, sourceSel.firstChild);
  sourceSel.value = 'all';

  refreshBtn.addEventListener('click', load);
  sourceSel.addEventListener('change', load);

  function proxied(u){ return PROXY_BASE + "?url=" + encodeURIComponent(u); }

  async function load(){
    errEl.textContent = "";
    statusEl.textContent = "Loading…";
    grid.innerHTML = "";

    const chosen = sourceSel.value === 'all' ? FEEDS : [FEEDS[Number(sourceSel.value)]];
    let items = [];

    for (const feed of chosen){
      try{
        const res = await fetch(proxied(feed.url));
        if(!res.ok) throw new Error(`${feed.name} → HTTP ${res.status}`);
        const text = await res.text();
        const parsed = new window.DOMParser().parseFromString(text, "text/xml");

        const entries = [...parsed.querySelectorAll("item, entry")].slice(0, MAX_ITEMS_PER_FEED).map(n=>{
          const title = (n.querySelector("title")?.textContent || "").trim();
          const link = (n.querySelector("link")?.getAttribute("href") || n.querySelector("link")?.textContent || "").trim();
          const desc = (n.querySelector("description, summary, content")?.textContent || "").replace(/<[^>]+>/g,"").trim();
          const date = new Date(
            n.querySelector("pubDate, updated, published, dc\\:date")?.textContent || Date.now()
          );
          const media = n.querySelector("media\\:content, content, media\\:thumbnail, enclosure");
          const img = media?.getAttribute("url") || "";
          return {source: feed.name, title, link, desc, date, img};
        });

        items.push(...entries);
      }catch(e){
        console.error(e);
        errEl.textContent += `\n• ${feed.name}: ${e.message}`;
      }
    }

    items = items
      .filter(it=>it.title && it.link)
      .sort((a,b)=>b.date - a.date)
      .slice(0, MAX_TOTAL_ITEMS);

    for (const it of items){
      const card = document.createElement('div'); card.className = 'card';
      const src  = document.createElement('div'); src.className = 'src'; src.textContent = it.source;
      const a    = document.createElement('a'); a.className = 'title'; a.href = it.link; a.target = "_blank"; a.rel="noopener"; a.textContent = it.title;
      const img  = document.createElement('img'); img.className='thumb';
      if (it.img){ img.src = it.img; img.onload=()=>{ img.style.display='block'; }; }
      const desc = document.createElement('div'); desc.className = 'desc'; desc.textContent = it.desc.slice(0,220) + (it.desc.length>220 ? "…" : "");
      const meta = document.createElement('div'); meta.className='meta'; meta.textContent = it.date.toLocaleString();

      card.append(src,a,img,desc,meta);
      grid.appendChild(card);
    }
    statusEl.textContent = `Showing ${items.length} item(s) from ${sourceSel.value==='all' ? FEEDS.length : 1} source(s).`;
  }

  load();
  </script>
</body>
</html>
